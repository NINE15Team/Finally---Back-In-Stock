generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["relationJoins"]
}

datasource db {
  provider          = "postgresql"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model Session {
  id          String    @id
  shop        String
  state       String
  isOnline    Boolean   @default(false)
  scope       String?
  expires     DateTime?
  accessToken String
  userId      String?
}

model ShopifyStoreInfo {
  id                 Int                 @id @default(autoincrement())
  storeId            String              @map("store_id")
  storeName          String              @map("store_name")
  shopifyURL         String              @map("shopify_url")
  createdAt          DateTime            @default(now()) @map("created_at")
  updatedAt          DateTime            @default(now()) @updatedAt @map("updated_at")
  isActive           Boolean             @default(true) @map("is_active")
  productInfo        ProductInfo[]
  EmailConfiguartion EmailConfiguartion?

  @@unique([storeName])
  @@map("store_info")
}

model ProductInfo {
  id                   Int                    @id @default(autoincrement())
  storeId              Int                    @map("store_id")
  store                ShopifyStoreInfo       @relation(fields: [storeId], references: [id]) // This establishes the relationship
  productURI           String                 @map("product_uri")
  productId            String                 @map("product_id")
  productTitle         String                 @default("Default Product") @map("product_title")
  variantId            String                 @map("variant_id")
  variantTitle         String                 @default("Default Variant") @map("variant_title")
  status               Boolean                @default(false)
  inStock              Boolean                @default(false)
  createdAt            DateTime               @default(now()) @map("created_at")
  updatedAt            DateTime               @default(now()) @updatedAt @map("updated_at")
  isActive             Boolean                @default(true)
  CustomerSubscription CustomerSubscription[]

  @@unique([productId, variantId])
  @@map("product_info")
}

model CustomerSubscription {
  id            Int         @id @default(autoincrement())
  productInfoId Int         @map("product_info_id")
  productInfo   ProductInfo @relation(fields: [productInfoId], references: [id]) // This establishes the relationship
  customerEmail String      @default("Default Email") @map("customer_email")
  status        Boolean     @default(false) @map("status")
  isNotified    Boolean     @default(false) @map("is_notified")
  createdAt     DateTime    @default(now()) @map("created_at")
  updatedAt     DateTime    @default(now()) @updatedAt @map("updated_at")
  isActive      Boolean     @default(true)

  @@unique([customerEmail, productInfoId])
  @@map("customer_subscription")
}

model EmailConfiguartion {
  id               Int              @id @default(autoincrement())
  storeId          Int              @map("store_id")
  store            ShopifyStoreInfo @relation(fields: [storeId], references: [id]) // This establishes the relationship
  senderName       String           @default("") @map("sender_name")
  senderEmail      String           @default("") @map("sender_email")
  isEmailVerified  Boolean          @default(false) @map("email_verified")
  headerContent    String           @default("") @map("header_content")
  headerFontFamily String           @default("") @map("header_font_family")
  headerFontSize   String           @default("") @map("header_font_size")
  headerBgColor    String           @default("") @map("header_bg_color")
  bodyContent      String           @default("") @map("body_content")
  bodyFontFamily   String           @default("") @map("body_font_family")
  bodyFontSize     String           @default("") @map("body_font_size")
  bodyBgColor      String           @default("") @map("body_bg_color")
  footerContent    String           @default("") @map("footer_content")
  footerFontFamily String           @default("") @map("footer_font_family")
  footerFontSize   String           @default("") @map("footer_font_size")
  footerBgColor    String           @default("") @map("footer_bg_color")
  createdAt        DateTime         @default(now()) @map("created_at")
  updatedAt        DateTime         @default(now()) @updatedAt @map("updated_at")

  @@unique([storeId])
  @@map("email_configuartion")
}
